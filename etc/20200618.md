# Docker で Xdebug

cakePHPなどのフレームワークを触る機会が多くなり、Xdebugのお世話になることが多くなってきました。

WEBサイトをリロードしてPHPの動きを追えるのは本当にありがたい。

しかし、導入までちょっと苦労したので、覚書として残します。

ちなみに、開発環境は色々あると思いますが、今は Docker を使用しています。

## どこで動かすか

エディターは、VS Code。
自分のMac または、会社の Windows で運用です。

ここで、選択肢として2つ考える必要があります。

一体どこの Xdebug を使用するのか・・・。

Xdebug は、PHP 上で動くモジュールなので、PHPが動作している環境の必要があります。

でも、Mac は PHP が動いてますし、もちろん Docker でも動いてます。

Windows は、PHPをインストールすれば同様になります。

## ローカルで Xdebug

Mac や Windows に PHP が入っているなら、ローカルで Xdebug を動かすのがいいのかもしれません。

Docker の中で Git 管理ができない(環境の構築と破壊をした際に消えるので意味がない)ので、必然的に Windows の Git を使用することになります。
VS Code 内で Git の操作をしたい場合、ローカルの Xdebug を使用するほうがいいでしょう。

ただし、複数の環境を持っている場合・・・たとえば、プロジェクトA は PHP7、プロジェクトBは PHP5 など違ったバージョンで運用が必要な場合 Docker はいいとして、ローカルの PHP 環境をいちいち切り替えるのも面倒ということもあります。

また PHP 導入に関しては Mac の場合もとから PHP が動くので問題ありませんが Windows の場合はちょっと考える必要があります。

### PHP 導入について

#### Windows

Windows に PHP をインストールするのか WSL にインストールするのか・・・。

正確ではありませんが、僕の理解では WSL は Windows の中で Linux を動かすための・・・仮想環境のようなものと考えています。

そこに PHP をインストールすればいいようにも思いますがフォルダーの位置が深いところにできてしまうとか Docker と Windows の関係に1つ加わるので、ちょっと遠回りでわかりにくいような気もします。

また、Docker自体の立ち上げる場所も、WSL 内でインストールして立ち上げるのか、Docker For Windows を使うのか・・・。

かなり幅広い選択肢が出てきます。

結局、僕の環境では Docker For Windows を使用して PHP は Windows に入れました。

#### Mac

Mac はもともと PHP が動きますので、とくにすることはありませんが、home brew で PHP7 を入れてしまったので、phpenv で環境を変更しました。

ちなみに、Docker は Docker For Mac がデフォルトスタンダードだと思います。
ちょっと前まで、Vagrant で Docker を立ち上げたほうが早いと言うようなこともありましたが、今はあまり違和感なく Docker For Mac で使えています。

### Git 管理について

前述しましたが Git は基本的に Docker 内で使用しないので、Windows や Mac ローカルの Git で運用することになります。


### Docker 内で Xdebug

indows に PHP を入れたくない場合でも、Dockerの中なら関係ないので普通に使用可能なので便利です。

PHP環境を意識しなくてもいい Docker 上で済ますのか、Git管理ができる Mac ローカルで運用すべきか・・・。


